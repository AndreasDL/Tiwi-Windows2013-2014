<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="generator" content="intranetr/0.10.0">
<title>Reeks 5 | iii intranet</title>    <link rel="stylesheet" type="text/css" media="screen,handheld" href="../../../css/default.css?0.10.0">
    <link rel="stylesheet" type="text/css" media="print" href="../../../css/print.css?0.10.0">
    <link rel="stylesheet" type="text/css" media="screen,handheld" href="../../../css/sites/default.css">
    <script type="text/javascript" src="../../../js/cache/0d6197553acf19ea859c96f7caf7d8fa6c6519b8.js?0.10.0"></script>
<!--[if lt IE 8]>
<link rel="stylesheet" type="text/css" href="/css/ie.css">
<![endif]-->
    <script type="text/javascript">
    (function() {
        var month = 8;
        iii.semester = month == 1 ? 1
            : month <= 6 ? 2
            : month <= 9 ? 0 : 1;
        if (iii.semester > 0) {
            var hideOtherSemester = function() {
                var other = iii.semester == 1 ? 2 : 1;
                $('#breadcrumbs li.group-sem'
                        + other
                        + ':not(.group-sem'
                        + iii.semester + '):not(.active)')
                    .hide();
            };
            $(document)
                .ready(hideOtherSemester)
                .on("contentUpdate.iii", hideOtherSemester);
        }
    })();
    </script>
</head>

<body>
    <div id="header"><h1>
    <a href="../../../index.html" title="Naar de thuispagina">
        intranet
    </a>
</h1>
</div>
<div id="main">    <div id="node-children">
    <ul>
            <li><a href="../index.html"><span style="float: right">&#8593;</span>Omhoog</a></li>
            </ul>
    </div>

<div id="content" class="">
        <div id="breadcrumbs-container">
    <span id="you-are-here">Je bent hier:</span>
    <ul id="breadcrumbs">
                            <li class="breadcrumb first"><a href="../../../index.html" class="breadcrumb first">Intranet</a>
                </li>
                            <li class="breadcrumb"><a href="../../index.html" class="breadcrumb">Windows</a>
                    <ul class="breadcrumb-siblings">
                                                <li class="separator"><span>Tweede bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Besturingssystemen-I/index.html">Besturingssystemen I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Computernetwerken-I/index.html">Computernetwerken I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Informatica-II/index.html">Informatica II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Softwareontwikkeling-I/index.html">Softwareontwikkeling 1</a></li>
                                                                <li class="separator"><span>Derde bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Algoritmen-I/index.html">Algoritmen I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2 leaf"><a class="breadcrumb-sibling group-sem2 leaf" href="../../../Computergrafiek/index.html">Computergrafiek</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Computernetwerken-II/index.html">Computernetwerken II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Computernetwerken-III/index.html">Computernetwerken III</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Databanken/index.html">Databanken</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Design-Patterns/index.html">Design Patterns</a></li>
                                                                                                                                                                                                                                                            <li class="breadcrumb-sibling group-sem1 group-sem2"><a class="breadcrumb-sibling group-sem1 group-sem2" href="../../../Hardware/index.html">Hardware</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../OGP/index.html">OGP</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Systeemanalyse-I/index.html">Systeemanalyse I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../UNIX/index.html">UNIX</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Beveiliging/index.html">Beveiliging</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Computernetwerken-IV/index.html">Computernetwerken IV</a></li>
                                                                                                                                                                                                                                                            <li class="breadcrumb-sibling group-sem1 group-sem2 leaf"><a class="breadcrumb-sibling group-sem1 group-sem2 leaf" href="../../../Masterproef/index.html">Masterproef</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Systeemanalyse-II/index.html">Systeemanalyse II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 active"><a class="breadcrumb-sibling group-sem1 active" href="../../index.html">Windows</a></li>
                                                                <li class="separator"><span>Algemeen</span></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Activiteiten/index.html">Activiteiten</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Huisregels-labos/index.html">Huisregels voor labo&#039;s</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Opleiding-Informatica/index.html">Opleiding Informatica GTI</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Andere-problemen/index.html">Probleemoplossende instanties</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling"><a class="breadcrumb-sibling" href="../../../Roosters/index.html">Roosters</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="../index.html" class="breadcrumb">Labo</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling active"><a class="breadcrumb-sibling active" href="../index.html">Labo</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../Theorie/index.html">Theorie</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="../p5.1" class="breadcrumb">Reeks 5</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p0.1">Reeks 0</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p1.1">Reeks 1</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p2.1">Reeks 2</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p3.1">Reeks 3</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p4.1">Reeks 4</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf active current"><a class="breadcrumb-sibling leaf active current" href="../p5.1">Reeks 5</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p6.1">Reeks 6</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p7.1">Reeks 7</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p8.1">Reeks 8</a></li>
                                        </ul>
                </li>
        </ul>
    </div>
    <h2>Reeks 5</h2>
    <div id="page-content">
        <h3>PowerShell en WMI</h3>
<h5>Inleiding PowerShell</h5>
Windows PowerShell v2 is beschikbaar voor alle Windows-versies
vanaf Windows XP(inclusief Windows Server 2003, Windows Vista,
Windows Server 2008, Windows Server 2008 R2, and Windows 7). Het is
"preinstalled" voor Win2008R2 and Win7 (en latere versies), maar
moet niet manueel geïnstalleerd worden in oudere versies. Zoek
"powershell 2" op <a href=
"http://download.microsoft.com">http://download.microsoft.com</a>
of op <a href=
"http://support.microsoft.com/kb/968930">http://support.microsoft.com/kb/968930</a><br>

Op de labotoestellen is Windows Powershell v1 geïnstalleerd, dat
volstaat voor dit labo.
<p>Raadpleeg <a href="powershell_reference.pdf">deze
samenvatting</a> en <a href="Powershell.pdf">powerpoint les</a> om
snel aan de slag te gaan.</p>
<p>Opstarten via
<em>C:\Windows\System32\WindowsPowershell\V1.0</em>. Start
<strong>PowerShell_ISE.exe</strong> als administrator. Je typt
commando's in het "Command Pane" of in het "Script Pane".
Variabelen zijn voor beiden direct beschikbaar.</p>
<dl class="compact">
<dt>1.</dt>
<dd>Met welke parameter van de cmdlet <strong>Get-Command</strong>
kan je een deel van het gezochte commando opgeven. Deze parameter
aanvaardt wildcards.<br>
Zoek alle cmdlets waarmee je processen kan aanspreken. Hoe kan je
een lijst met alle processen ophalen?
<p><a class="popout" href="01.ps1">voorbeeld</a></p>
</dd>
<dt>2.</dt>
<dd>Welke parameters zijn beschikbaar voor de cmdlet
<strong>Sort-Object</strong> en <strong>Select-Object</strong>
?<br>
Toon nu de 10 processen met het hoogste aantal Handles. Je kan dit
commando op veel plaatsen inkorten (aliassen gebruiken, switchen
weglaten, woorden inkorten)
<p><a class="popout" href="02.ps1">voorbeeld</a></p>
</dd>
<dt>3.</dt>
<dd>Bekijk de parameters van de cmdlet
<strong>Group-Object</strong>.<br>
Toon de 10 werkwoorden die meest voorkomen in een commando. Je
ontdekt o.a. dat er 176 commando's zijn zonder werkwoord.<br>
Hoe kan je het overzicht aanpassen zodat je enkel informatie krijgt
over <em>cmdlet</em>-commando's.
<p><a class="popout" href="03.ps1">voorbeeld</a></p>
</dd>
<dt>4.</dt>
<dd>Toon alle properties die beschikbaar zijn voor een cmdlet.
Beperk het overzicht tot de properties (geen methodes)<br>
Gebruik nu de juiste property om een lijst te tonen van alle
commando's zonder werkwoord. Je moet daarbij gebruik maken van
<strong>Where-Object</strong> met de vergelijkingsoperator
<strong>-match</strong>.<br>
Hoe kan je snel nagaan dat dit hoofdzakelijk Aliassen zijn ?
<p><a class="popout" href="04.ps1">antwoord</a></p>
</dd>
<dt>5.</dt>
<dd>Initialiseer een variabele met één proces, neem bijvoorbeeld
het eerste proces.<br>
Nu kan je heel eenvoudig alle threads van dit proces opvragen, en
ook het aantal threads.<br>
Toon nu alle processen met exact twee threads. Toon ook de
Threadnummers.
<p><a class="popout" href="05.ps1">voorbeeld</a></p>
</dd>
<dt>6.</dt>
<dd>Toon alle services die gestopt zijn. Zoek eerst de naam van de
cmdlet, en bekijk de attributen van 'service'-objecten<br>
Bepaal het totaal aantal services voor elke status.<br>
Toon enkel de services die minstens 1 afhankelijke service
hebben.<br>
Beperk je verder tot services die minstens 2 afhankelijke services
hebben.
<p><a class="popout" href="06.ps1">antwoord</a></p>
</dd>
<dt>7.</dt>
<dd>Toon alle bestanden van de huidige map, gesorteerd op datum (de
recentste eerst). Je kan hierbij vertrekken van de gekende alias
"dir".<br>
Beperk het overzicht tot bestanden die na 1/10/2013 zijn gewijzigd
en toon enkel de naam en de datum. Merk op de een datum begint met
de "maand"
<p><a class="popout" href="07.ps1">antwoord</a></p>
</dd>
<dt>8.</dt>
<dd>Er zijn in PowerShell heel wat bewerkingen beschikbaar op
specifieke objecten. We bekijken de mogelijkheden van een
tijd-object. Je kan dit terugvinden door een variabele te
initialiseren met een tijd, en van die variabele de beschikbare
methodes en attributen op te vragen. Bepaal nu alle bestanden van
de huidige map die in op een zondag laatst aangepast werden. Toon
voor die bestanden de naam, en enkel het uur van de dag.<br>
<strong>Tip</strong>: Bekijk in de voorbeelden van Select-Object
hoe je berekeningen kan doen op de variabelen.
<p><a class="popout" href="08.ps1">antwoord</a></p>
</dd>
</dl>
<h4>WMI en PowerShell</h4>
Je kan WMI-objecten initialiseren als COM-objecten, met analoge
functionaliteit als in perl. We noemen dit WMI-COM-objecten. Je kan
ook de cmdlet <strong>Get-WmiObject</strong> gebruiken. Dit noemen
we PS-WMI-objecten.<br>
Elke oefening kan dus steeds op twee manieren opgelost worden.
Beide methodes hebben voor- en nadelen.
<dl class="compact">
<dt>9.</dt>
<dd>Toon alle beschikbare properties van het WMI-COM-object dat de
klasse Win32_LogicalDisk representeert, vergelijk dit met de
properties van het PS-WMI-object dat deze klasse representeert.<br>
Hoe kan je alle WMI-properties tonen van deze klasse.<br>
Toon de waarde van het WMI-attribuut __DERIVATION
<p><a class="popout" href="09.ps1">voorbeeld</a></p>
</dd>
<dt>10.</dt>
<dd>Herneem vorige oefening voor één instantie van de klasse (maakt
niet uit welke instantie).<br>
Toon ook de inhoud van een aantal interessante WMI-eigenschappen
(DeviceID, VolumeName, Description) van deze instantie. Vraag ook
een systeemattribuut van deze instantie
<p>Met welke methode kan je heel eenvoudig deze WMI-eigenschappen
ophalen voor alle instanties ?</p>
<p><a class="popout" href="10.ps1">antwoord</a></p>
</dd>
<dt>11.</dt>
<dd>(enkel cmdlets) Bekijk de mogelijkheden van de parameter -view
van de cmdlet Get-Member. Welke interessante properties kan je nu
extra opvragen?<br>
Het overzicht is verschillend voor een WMI-klasse en een
WMI-object.
<p><a class="popout" href="11.ps1">voorbeeld</a></p>
</dd>
<dt>12.</dt>
<dd>(enkel comlets) Gebruik dit nu om alle "eigen" WMI-attributen
te tonen van de klasse Win32_LogicalDisk
<p><a class="popout" href="12.ps1">antwoord</a></p>
</dd>
<dt>13.</dt>
<dd>Bepaal het aantal "eigen" WMI-attributen van de klasse
Win32_LogicalDisk
<p><a class="popout" href="13.ps1">voorbeeld</a></p>
</dd>
<dt>14.</dt>
<dd>Bepaal de klasse met het grootste aantal "eigen"
attributen.<br>
Met WMI-com-objecten haal je alle klassen op met een query. Je moet
veel meer code zelf schrijven.
<p><a class="popout" href="14.ps1">antwoord</a></p>
</dd>
<dt>15.</dt>
<dd>Bepaal alle instanties van Win32_LogicalDisk, toon enkel het
relatief pad. Bekijk de mogelijkheden van het attribuut Path_<br>
Bepaal ook het aantal instanties.
<p><a class="popout" href="15.ps1">antwoord</a></p>
</dd>
<dt>16.</dt>
<dd>Bepaal alle WMI-methodes van de klasse Win32_LogicalDisk
<p><a class="popout" href="16.ps1">antwoord</a></p>
</dd>
<dt>17.</dt>
<dd>Bepaal alle klassequalifiers voor de klasse Win32_LogicalDisk.
Toon ook de waarde van elke qualifier.<br>
Toon nu enkel de "beschrijving" van de klasse.
<p><a class="popout" href="17.ps1">antwoord</a></p>
</dd>
<dt>18.</dt>
<dd>Toon de beschrijving van alle Win32-klassen die iets met
NetWorkAdapter te maken hebben.
<p><a class="popout" href="18.ps1">antwoord</a></p>
</dd>
<dt>19.</dt>
<dd>Toon alle methodes + methodequalifiers voor Win32_Process
<p><a class="popout" href="19.ps1">antwoord</a></p>
</dd>
<dt>20.</dt>
<dd>Beperk de lijst tot methodes die een tekstuele interpretie
hebben voor de return-value. Geef ook een mooie voorstelling voor
die tekstuele interpretatie
<p><a class="popout" href="20.ps1">antwoord</a></p>
</dd>
<dt>21.</dt>
<dd>(enkel cmdlets) Zoek de klasse die eventfiles beschrijft. Zoek
het attribuut dat aangeeft wanneer de eventfile laatst gewijzigd
werd. Geef nu een overzicht van alle eventfiles, geordend op
laatst-gewijzigd<br>
Als je nu ook de datum vraagt, dan wordt die als getal (aantal
seconden sinds...) getoond. Voor dit soort objecten beschik je in
powershell over extra "scriptmethodes", waarmee je een datum kan
converteren. Bepaal alle (script) methodes van het PS-object dat
een evenfile beschrijft.<br>
Converteer nu de datum van één eventfile.<br>
Pas nu het overzicht aan zodat de datum geconverteerd wordt, en dus
als datum kan geïnterpreteerd worden (zie ook oefening 8).
<p><a class="popout" href="21.ps1">antwoord</a></p>
</dd>
</dl>
<h5>Extra opgaven</h5>
<dl class="compact">
<dt>22.</dt>
<dd>Voor processen beschik je ook over de cmdlet
<strong>get-Process</strong>. Vergelijk de methodes en properties
van het PS-process object, met het PS-WMI-object. Toon alle
beschikbare methodes en properties voor het WMI-object
Win32_Process, vergelijk dit met de mogelijkheden van de cmdlet
<strong>get-Process</strong><br>
Let op het verschil voor een WMI-klasse of een WMI-instantie.
<p><a class="popout" href="22.ps1">antwoord</a></p>
</dd>
<dt>23.</dt>
<dd>Herneem oefening6, maar gebruik hiervoor de PS-WMI-klassen. De
informatie over afhankelijke services kan je nu niet terugvinden in
properties. Je moet dus alle geassocieerde klassen bepalen
hiervoor. Dit werkt je voorlopig niet uit.<br>
Indien je WMI-Com-objecten gebruikt moet je soms veel meer code
schrijven.
<p><a class="popout" href="23.ps1">antwoord</a></p>
</dd>
<dt>24.</dt>
<dd>Toon een aantal interessante properties (Caption, Description
en FileSystem) van de logical disk die hoort bij C:
<p>De cmdlet <strong>Get-WmiObject</strong> heeft twee parameters (
<strong>-filter</strong> en <strong>-query</strong> ) om de lijst
te beperken. Je kan ook het <strong>Where-Object</strong>
gebruiken.</p>
<p><a class="popout" href="24.ps1">antwoord</a></p>
</dd>
<dt>25.</dt>
<dd>Start zelf minstens 1 keer Notepad op. Toon nu de naam en het
handlenummer van (alle) Notepad-processen.
<p><a class="popout" href="25.ps1">antwoord</a></p>
</dd>
<dt>26.</dt>
<dd>Toon alle klassen die beschikbaar zijn in de standaard
namespace (root/CimV2). Toon ook hoeveel klassen dit zijn.<br>
Hoe beperk je het overzicht tot klassen die iets met "network" te
maken hebben.<br>
Toon ook alle systeemklassen van de namespace "root".
<p><a class="popout" href="26.ps1">antwoord</a></p>
</dd>
<dt>27.</dt>
<dd>Toon alle namespaces, startend vanaf "root\cimV2". Schrijf
hiervoor een recursieve functie.<br>
Indien je onvoldoende rechten hebt, dan resulteert dit in een fout.
<p><a class="popout" href="27.ps1">antwoord</a></p>
</dd>
<dt>28.</dt>
<dd>(enkel cmdlets) Bepaal alle event-klassen die expliciet door
een provider zijn toegevoegd (van welke klassen zijn ze
afgeleid?).<br>
Orden dit overzicht op aantal eigen attributen properties van elke
klasse.<br>
Geef ook een lijst met de eigen properties voor elke klasse
<p><a class="popout" href="28.ps1">antwoord</a></p>
</dd>
<dt>29.</dt>
<dd>Oefening 12 uit reeks p4.<br>
Merk op dat CIMTYPE niet numeriek is.
<p><a class="popout" href="29.ps1">antwoord</a></p>
</dd>
<dt>30.</dt>
<dd>Oefening 13 uit reeks p4
<p><a class="popout" href="30.ps1">antwoord</a></p>
</dd>
<dt>31.</dt>
<dd>(enkel cmdlets) Oefening 14 uit p4. Bekijk nog eens oefening 23
om de data te converteren. Deze methode is enkel ter beschikking
indien je PS-WMI-objecten gebruikt.
<p><a class="popout" href="31.ps1">antwoord</a></p>
</dd>
<dt>32.</dt>
<dd>(enkel cmdlets) Oefening 18 uit p4.
<p><a class="popout" href="32.ps1">antwoord</a></p>
</dd>
<dt>33.</dt>
<dd>Maak oefening 29 uit p4. Je mag de klasse hardcoderen. De
attribuutqualifier CIMTYPE vind je niet terug als je met cmdlets
werkt.
<p><a class="popout" href="33.ps1">antwoord</a></p>
</dd>
<dt>34.</dt>
<dd>Toon alle abstracte klassen waarvan de naam begint met WIN32.
Toon ook het aantal abstacte klassen.
<p><a class="popout" href="34.ps1">antwoord</a></p>
</dd>
</dl>

        <div id="page-content-end"></div>
    </div>
    <div id="footer">    <div id="metadata">
    Laatst gewijzigd
            op
        05-11-2013
        om
        19:17
        
                door
                    <a href="mailto:Marleen.Denert@UGent.be">Marleen Denert</a>
                
        
    </div>
<div id="tag">intranetr/0.10.0</div>
<div id="footer-end"></div>
</div>
</div>
</div>
</body>

</html>

<!-- 90 ms / 571 KB -->
