<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="generator" content="intranetr/0.10.0">
<title>Reeks 2 | iii intranet</title>    <link rel="stylesheet" type="text/css" media="screen,handheld" href="../../../css/default.css?0.10.0">
    <link rel="stylesheet" type="text/css" media="print" href="../../../css/print.css?0.10.0">
    <link rel="stylesheet" type="text/css" media="screen,handheld" href="../../../css/sites/default.css">
    <script type="text/javascript" src="../../../js/cache/0d6197553acf19ea859c96f7caf7d8fa6c6519b8.js?0.10.0"></script>
<!--[if lt IE 8]>
<link rel="stylesheet" type="text/css" href="/css/ie.css">
<![endif]-->
    <script type="text/javascript">
    (function() {
        var month = 8;
        iii.semester = month == 1 ? 1
            : month <= 6 ? 2
            : month <= 9 ? 0 : 1;
        if (iii.semester > 0) {
            var hideOtherSemester = function() {
                var other = iii.semester == 1 ? 2 : 1;
                $('#breadcrumbs li.group-sem'
                        + other
                        + ':not(.group-sem'
                        + iii.semester + '):not(.active)')
                    .hide();
            };
            $(document)
                .ready(hideOtherSemester)
                .on("contentUpdate.iii", hideOtherSemester);
        }
    })();
    </script>
</head>

<body>
    <div id="header"><h1>
    <a href="../../../index.html" title="Naar de thuispagina">
        intranet
    </a>
</h1>
</div>
<div id="main">    <div id="node-children">
    <ul>
            <li><a href="../index.html"><span style="float: right">&#8593;</span>Omhoog</a></li>
            </ul>
    </div>

<div id="content" class="">
        <div id="breadcrumbs-container">
    <span id="you-are-here">Je bent hier:</span>
    <ul id="breadcrumbs">
                            <li class="breadcrumb first"><a href="../../../index.html" class="breadcrumb first">Intranet</a>
                </li>
                            <li class="breadcrumb"><a href="../../index.html" class="breadcrumb">Windows</a>
                    <ul class="breadcrumb-siblings">
                                                <li class="separator"><span>Tweede bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Besturingssystemen-I/index.html">Besturingssystemen I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Computernetwerken-I/index.html">Computernetwerken I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Informatica-II/index.html">Informatica II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Softwareontwikkeling-I/index.html">Softwareontwikkeling 1</a></li>
                                                                <li class="separator"><span>Derde bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Algoritmen-I/index.html">Algoritmen I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2 leaf"><a class="breadcrumb-sibling group-sem2 leaf" href="../../../Computergrafiek/index.html">Computergrafiek</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Computernetwerken-II/index.html">Computernetwerken II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../Computernetwerken-III/index.html">Computernetwerken III</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Databanken/index.html">Databanken</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Design-Patterns/index.html">Design Patterns</a></li>
                                                                                                                                                                                                                                                            <li class="breadcrumb-sibling group-sem1 group-sem2"><a class="breadcrumb-sibling group-sem1 group-sem2" href="../../../Hardware/index.html">Hardware</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem2"><a class="breadcrumb-sibling group-sem2" href="../../../OGP/index.html">OGP</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Systeemanalyse-I/index.html">Systeemanalyse I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../UNIX/index.html">UNIX</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Beveiliging/index.html">Beveiliging</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="../../../Computernetwerken-IV/index.html">Computernetwerken IV</a></li>
                                                                                                                                                                                                                                                            <li class="breadcrumb-sibling group-sem1 group-sem2 leaf"><a class="breadcrumb-sibling group-sem1 group-sem2 leaf" href="../../../Masterproef/index.html">Masterproef</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="../../../Systeemanalyse-II/index.html">Systeemanalyse II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 active"><a class="breadcrumb-sibling group-sem1 active" href="../../index.html">Windows</a></li>
                                                                <li class="separator"><span>Algemeen</span></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Activiteiten/index.html">Activiteiten</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Huisregels-labos/index.html">Huisregels voor labo&#039;s</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Opleiding-Informatica/index.html">Opleiding Informatica GTI</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../../Andere-problemen/index.html">Probleemoplossende instanties</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling"><a class="breadcrumb-sibling" href="../../../Roosters/index.html">Roosters</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="../index.html" class="breadcrumb">Labo</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling active"><a class="breadcrumb-sibling active" href="../index.html">Labo</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../../Theorie/index.html">Theorie</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="../p2.1" class="breadcrumb">Reeks 2</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p0.1">Reeks 0</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p1.1">Reeks 1</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf active current"><a class="breadcrumb-sibling leaf active current" href="../p2.1">Reeks 2</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p3.1">Reeks 3</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p4.1">Reeks 4</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p5.1">Reeks 5</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p6.1">Reeks 6</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p7.1">Reeks 7</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="../p8.1">Reeks 8</a></li>
                                        </ul>
                </li>
        </ul>
    </div>
    <h2>Reeks 2</h2>
    <div id="page-content">
        <h3>het Excel object model</h3>
<h4>Verplichte voorbereiding:</h4>
<ol>
<li>De uitleg van <a href="../labo1.ppt">het eerste labo</a> kan je
nog eens doornemen. Lees ook reeks0 nog eens helemaal door.</li>
<li>Werk de oefeningen uit de vorige reeks af tot en met oefening
15.</li>
<li>Herhaal de syntax van Perl. Breng je nota's mee van vorig jaar.
In <a href="../perl_herhaling.html">herhaling Perl</a> vind je een
kort overzicht van wat je vorig jaar geleerd hebt.</li>
<li>Herhaal hoe je in Perl met matrices kan werken.</li>
<li>Je mag steeds gebruik maken van <a href=
"../references.html">interessante referenties</a> in de
MSDN-library - ook voor de testen.</li>
</ol>
<h4>Aan de slag met Excel</h4>
De tak <em>Office Solutions Development / 2007 Microsoft Office
System</em> van de <strong>MSDN Library</strong> bevat uitgebreide
documentatie over diverse Office-toepassingen (versie&nbsp;2003 en
versie&nbsp;2007).<br>
We beperken ons in deze labo's tot <strong>Excel</strong> en
behandelen in deze sessie enkel een paar elementaire aspecten van
het Excel object model, zonder formules of grafieken. Documentatie
zoek je op in de sectie <em>Office Solutions Development / 2007
Microsoft Office System / Excel 2007 / Excel 2007 Developer
Reference</em> , die we in deze notas de <strong>Excel 2007
Documentatie</strong> zullen noemen. In de subtak <em>Excel Object
Model Reference / Excel Object Model Map / Object Model Map</em>
vind je de volledige hiërarchie van Excel. We beperken ons tot het
<strong>Application</strong> object, en gebruiken enkel
sub-objecten/collecties die <strong>non-exposed</strong> zijn, dit
wil zeggen dat ze geen eigen <em>ProgID</em> hebben, maar via een
attribuut worden geïnitialiseerd.
<p>In het <strong>register</strong> zijn er meerdere
COM-componenten die elk een deel van de functionaliteit van Excel
implementeren. De component <strong>"Excel.Application"</strong>
stelt een volledige Excel-applicatie voor. Zoek de
<strong>GUID</strong> en <strong>ProgId</strong> op in het
register. Bekijk verder de informatie in de bijhorende
<strong>CLSID-tak</strong>. Je vindt geen subtak
<strong>Typelib</strong>. Om de Type Library terug te vinden bekijk
je in het register de component <strong>"Excel.Sheet"</strong>.
Daar vind je in de subtak <strong>Typelib</strong> de GUID van de
Excel Type Library. De naam van deze Type Library is <em>Microsoft
Excel 12 Object Library</em> (versie-afhankelijk), en kan je
terugvinden in <strong>Oleview</strong>. Om de constanten uit de
voorbeelden te kunnen gebruiken kan je dus best naar deze Type
Library refereren, zie reeks1.</p>
<p>Initialiseer met het <strong>Application</strong> object een
nieuwe Excel-applicatie. Hierdoor wordt Excel opgestart in
<em>embedded mode</em>. Dit betekent dat je niet ziet dat Excel
opgestart is. Bij het beëindigen van je script wordt de applicatie
niet steeds automatisch afgesloten: je moet hiervoor expliciet de
OLE-methode <strong>quit</strong> oproepen. Vooral indien een fout
optreedt tijdens het uitvoeren van een script, kan het gebeuren dat
het Excel proces in embedded mode niet correct afgesloten wordt.
Sluit in die gevallen dan zelf Excel af, met behulp van de
<strong>Task Manager</strong>.</p>
<p>In PerlScript zijn er drie interessante mogelijkheden voor het
initialiseren van een referentie naar Excel. Meer informatie
hierover vind je in de <strong>Perl-documentatie</strong> die
hiervoor werd opgegeven:</p>
<ul>
<li>een OLE-methode opgeven, die moet worden uitgevoerd als het
object wordt vernietigd:<br>
<strong>$excelAppl =
Win32::OLE-&gt;new('Excel.Application','quit');</strong></li>
<li>een referentie maken naar een Excel proces dat reeds is
opgestart (hierdoor vermijd je dat er meerdere Excel-processen
ingeladen worden):<br>
<strong>$excelAppl =
Win32::OLE-&gt;GetActiveObject('Excel.Application');</strong></li>
<li>een combinatie van beiden:<br>
<strong>$excelAppl =
Win32::OLE-&gt;GetActiveObject('Excel.Application') ||
Win32::OLE-&gt;new('Excel.Application', 'Quit');</strong></li>
</ul>
In de <strong>Perl-documentatie</strong> vind je onder de tak
<em>ActivePerl FAQ / Windows Specific FAQ / Using OLE with
Perl</em> een voorbeeldje dat bovenstaande code bevat.
<p>Een handig hulpmiddel bij het ontwikkelen van scripts is het
attribuut <strong>visible</strong> instellen op <strong>1
(true)</strong>. Nu wordt Excel ook op het scherm getoond, en kan
je eenvoudig Excel terug afsluiten als er iets fout gaat.</p>
<dl class="compact">
<dt>1.</dt>
<dd>&nbsp;<strong>Werkboek en werkblad:</strong> In Excel wordt elk
excel-bestand gekoppeld aan een <em>werkboek</em>. Elk werkboek
bevat één of meerdere <em>werkbladen</em>. Bekijk onderstaand
voorbeeld en merk op :
<ul>
<li>de collectie <strong>Workbooks</strong> bevat alle werkboeken
(-&gt; alle geopende Excelbestanden). In <em>embedded mode</em>
wordt er niet automatisch een werkbook geopend, zodat deze
collectie voorlopig leeg is.</li>
<li>de collectie <strong>Workbooks</strong> heeft methodes
<strong>Add, Open, Save, SaveAs, ...</strong> om een nieuw werkboek
toe te voegen, een bestaand werkboek te openen, een werkboek op te
slaan.</li>
<li>het <strong>workbook</strong> object (-&gt; één Excelbestand)
beschikt over een <em>collectie</em> van alle
<strong>Worksheets</strong> in dit <strong>workbook</strong>. Een
nieuw werkboek bevat bij een standaard configuratie telkens drie
werkbladen.</li>
<li>Elke individuele <strong>Worksheet</strong> heeft een
naam.</li>
<li>De collectie <strong>Worksheets</strong> bevat een methode
<strong>Add</strong>, die (vooraan) een nieuwe worksheet
toevoegt.</li>
</ul>
<p>Bij afsluiten van Excel zal een foutmelding getoond worden omdat
dit werkboek niet werd opgeslagen. Met het attribuut
<strong>DisplayAlerts</strong> kan je aangeven dat Excel geen
foutmeldingen moet tonen.</p>
<p><a class="popout" href="01.pl">voorbeeld</a></p>
</dd>
<dt>2.</dt>
<dd>&nbsp;<strong>Openen van bestaand Excel-bestand</strong>.
Schrijf een script dat als enige parameter de naam van een (excel-)
bestand meekrijgt. Indien dit bestand bestaat wordt het aantal
sheets van het bestand getoond, anders wordt een foutmelding
gegeven. Je kan hierbij gebruik maken van de
<strong>perl</strong>-functie <code>ref</code> of van de
<strong>Win32::OLE</strong> methodes <code>LastError</code> en
<code>QueryObjectType</code> (zie reeks 1).<br>
Je zal ondervinden dat de <em>Excel</em>-toepassing het bestand
niet gaat zoeken in de directory van waaruit je het script
aanroept, maar wel in de ingestelde default-directory van Excel.
Zoek in de <strong>Excel 2007 Documentatie</strong> het attribuut
dat deze default-directory onthoudt. Je kan dit ook vervangen door
de werkdirectory (zie reeks 1), dan lukt het wel om het bestand in
de huidige directory op te halen zonder de padnaam aan te
passen.<br>
<strong>Let op!</strong> De default-directory wordt enkel gewijzigd
voor de huidige sessie, en zal dus niet altijd werken zoals je
verwacht.<br>
Een betere oplossing is de volledige padnaam opbouwen, maar let
erop dat "\" gebruikt wordt.
<p><a class="popout" href="02.pl">antwoord</a></p>
</dd>
</dl>
Een worksheet kan in de <strong>Worksheets-</strong>collectie zowel
door zijn naam, als numeriek (startend vanaf 1, niet vanaf
0&nbsp;!) aangesproken worden, en bevat de uiteindelijke informatie
die we willen verwerken.<br>
Elk <strong>Worksheet</strong> object heeft een heleboel
subobjecten (o.a. ChartsObjects, PageSetup Object, ...) die we niet
verder zullen bespreken. Ook de verschillende <em>methods</em> die
je hierop kan toepassen, worden niet verder behandeld. Belangrijk
voor ons is de eigenlijke inhoud van dit object: deze bestaat uit
<strong>cellen</strong>. Je kan deze cellen individueel aanspreken,
maar je kan ook een geheel van cellen groeperen. Het begrip
<strong>Range-object</strong> staat voor een geheel van cellen in
zo'n Worksheet, en je kan deze toekennen met diverse attributen van
het <strong>Worksheet</strong>-object : <strong>Cells, Range,
Columns, Rows, UsedRange, ...</strong> .
<p>Overzichtelijke informatie en voorbeelden (in Visual Basic)
hierover vind je in de <strong>Excel 2007 Documentatie</strong>
terug in de subtakken <em>Concepts</em> en <em>How do I ... in
Excel 2007</em> .</p>
<p>De eenvoudigste manier, om informatie van een bestaand
Excel-bestand in bekomen, gebruikt het <em>attribuut</em>
<strong>UsedRange</strong> om alle gegevens van een bepaalde
<em>Worksheet</em> aan een <strong>Range</strong> object toe te
kennen. Je moet echter de <em>Range</em> niet activeren om te
kunnen verwerken (alhoewel dit in veel voorbeelden in de
MSDN-library wel gebeurt).<br>
Een <strong>Range</strong> object beschikt altijd over de
collectie-objecten <strong>rows</strong> en
<strong>columns</strong>. Elk element van deze collectie is zelf
ook een <em>range</em>-object. Met het attribuut
<strong>Count</strong> kan je weten hoeveel rijen (resp. kolommen)
de range heeft.</p>
<dl class="compact">
<dt>3.</dt>
<dd>&nbsp;<strong>Aantal rijen en kolommen van elk
werkblad</strong>. Schrijf een script dat als enige parameter de
naam van een (excel-) bestand meekrijgt. Geef voor elke
<em>werkblad</em> het aantal rijen en het aantal kolommen getoond
dat ingevuld is in elk <em>werkblad</em>. Je mag veronderstellen
dat het bestand een leesbaar excel-bestand is.<br>
Merk op dat een "leeg" werkblad niet herkend wordt. Er is altijd 1
rij en 1 kolom.
<p><a class="popout" href="03.pl">antwoord</a></p>
</dd>
<dt>4.</dt>
<dd>&nbsp;<strong>Inhoud van een werkblad.</strong> Om de inhoud
van een werkblad te manipuleren, initialiseer je een
<strong>Range</strong> object, en je vraagt de waarde van het
<em>default attribuut</em> <strong>Value</strong> op. Dit is
<strong>geen object</strong> maar een gewone variabele&nbsp;!
Meestal is het een array (éen- of twee- dimensionaal) maar het kan
ook leeg zijn of slechts 1 getal bevatten !! In
<em>Perl(Script)</em> bekom je eigenlijk een referentie en kan je
met <strong>ref</strong> nagaan of het een referentie naar een
array betreft.
<p>Pas het script aan zodat nu ook de inhoud getoond wordt (in
matrix-vorm) van elk <em>werkblad</em>.<br>
Zoek uit hoe je kan herkennen dat een werkblad leeg is, en
controleer of je oplossing altijd correct werkt.</p>
<p><strong>Tip:</strong> In de <strong>Perl-documentatie</strong>
vind je een goed voorbeeld in de tak <em>ActivePerl FAQ / Windows
Specific FAQ / Using OLE with Perl</em>, onder <em>How do I extract
a series of cells from Microsoft Excel?</em></p>
<p><a class="popout" href="04.pl">antwoord</a></p>
</dd>
<dt>5.</dt>
<dd>&nbsp;<strong>Delen van een worksheet ophalen</strong>.
Hieronder een paar voorbeelden die een beperkter deel van een
worksheet ophalen.
<pre>
    $range=$nsheet-&gt;Range("A1:D10");
    $range=$nsheet-&gt;Cells(4,1);
    $range=$nsheet-&gt;Range($nsheet-&gt;Cells(1,1),$nsheet-&gt;Cells(4,3));
</pre>
Schrijf de inhoud van deze range-objecten uit.
<p><a class="popout" href="05.pl">antwoord</a></p>
</dd>
<dt>6.</dt>
<dd>&nbsp;<strong>Range-objecten : wijzigen inhoud en
opmaak</strong><br>
De inhoud van een range-object kan worden gewijzigd door de
<strong>Value</strong> te wijzigen. Hierbij moet je wel letten op
de afmetingen van beiden. Experimenteer hiermee om de inhoud van
een deel van een sheet te wijzigen.<br>
Houd er rekening mee dat WSH scripts
<strong>geïnterpreteerd</strong> worden: probeer het aantal COM
interacties tot een minimum te beperken. Schrijf dus de ganse range
in één keer naar het Excel-bestand.<br>
Vergeet niet om het werkboek op te slaan!<br>
<strong>Let op!</strong> Als het Excel-bestand geopend is door
Excel, zal het niet lukken om dit bestand aan te passen...
<p><a class="popout" href="06.pl">antwoord</a></p>
</dd>
<dt>7.</dt>
<dd>Om de <strong>opmaak</strong> te wijzigen beschik je onder
andere over:
<ul>
<li>de <em>methode</em> <strong>Autofit</strong>, die echter niet
op elk <em>Range</em> object kan worden toegepast (zie
documentatie).</li>
<li>het <em>attribuut</em> <strong>font</strong>, dat een object
instelt die de volledige formattering van deze <em>range</em>
bevat. Zoek zelf de attributen van dit object op.</li>
<li>de <em>attributen</em> <strong>HorizontalAlignment,
VerticalAlignment</strong>, waarmee je de alignatie (uitlijning)
van alle cellen in de <em>range</em> kan manipuleren.</li>
<li>het <em>attribuut</em> <strong>Borders</strong>, dat een
collectie-object instelt die de randen van deze <em>range</em>
beschrijft.</li>
</ul>
Voor de twee laatste attributen moet je ook de numerieke waarden
kennen van een aantal excel constanten. Je kan deze constanten
opzoeken in de tak <em>Excel Object Model Reference /
Enumerations</em> van de <strong>Excel 2007 Documentatie</strong>
(en overtypen). Een betere oplossing is het inladen van de Type
Library <em>Microsoft Excel 12.0 Object Library</em> (zie
reeks&nbsp;1).
<p>Je kan ook een macro opnemen in Microsoft Office. Pas
onderstaand regeltje toe om de macro</p>
<pre>
        object.method(argument).property = value
</pre>
(in VBA) te converteren naar Perl:
<pre>
        $object-&gt;method(argument)-&gt;{property} = value;
</pre>
<p>Maak een nieuw excel-bestand, <em>voud.xlsx</em>, waarvan je 9
kolommen in het eerste werkblad invult. De eerste kolom bevat alle
tweevouden kleiner dan 100, de tweede kolom alle drievouden kleiner
dan honderd,...&nbsp; Op de eerste rij staan de waarden
2,3,4,...,10 in vet. Plaats ook border-lijnen, zowel vertikaal
tussen de kolommen, als horizontaal onder de eerste regel.</p>
<p><a class="popout" href="07.pl">antwoord</a></p>
</dd>
</dl>
Een groot deel van bovenstaande code kan je in Excel laten
genereren door een <strong>macro</strong> op te nemen met de
gewenste opmaak. De VBA-code van de macro gebruikt dezelfde
methodes en attributen. Het belangrijkste verschil is dat in de
macro steeds een range "geselecteerd" wordt - je vervangt dus
<code>Selection</code> door het range-object. Het bespaart je wel
veel opzoekwerk over de naam van de methodes en constanten.
<dl class="compact">
<dt>8.</dt>
<dd>&nbsp;<strong>Herhalingsoefening</strong><br>
Het Excel bestand <a href="punten.xls">punten.xls</a> bevat één
enkele worksheet. Kolom&nbsp;A van deze worksheet bevat de namen
van een aantal (fictieve) studenten, <strong>gesorteerd</strong> op
naam, terwijl kolom&nbsp;B de overeenkomstige (fictieve) punten,
behaald op vak<sub>1</sub> van een opleidingsonderdeel bevat. Het
bestand <a href="punten2.xls">punten2.xls</a> is volledig
gelijkaardig gestructureerd, maar bevat nu de punten, behaald op
vak<sub>2</sub> van hetzelfde opleidingsonderdeel. Dit bestand is
<strong>niet gesorteerd</strong> op naam. Schrijf een script dat:
<ol>
<li>de worksheet van punten.xls aanvult met twee kolommen:
kolom&nbsp;C moet de overeenkomstige punten, behaald op
vak<sub>2</sub> tonen, terwijl kolom&nbsp;D de score op het
opleidingsonderdeel (het gemiddelde van beide punten, afgerond op
volledige punten) moet bevatten,</li>
<li>punten.xls aanvult met een tweede worksheet, die de <em>ad
valvas</em> resultaten voor het opleidingsonderdeel toont. De stijl
van deze worksheet moet gelijkaardig zijn aan <a href=
"punten.pdf">volgende layout</a>: voor elke quotering
<strong>A</strong>, <strong>B</strong>, <strong>C</strong> en
<strong>D</strong> wordt een blok getoond bestaande uit vijf
kolommen, waarin de namen van de studenten worden getoond die deze
score behaalden. Elke blok wordt <strong>kolom per kolom</strong>
ingevuld (de laatste kolom of de laatste rij kan hierdoor een
kleiner aantal studenten bevatten dan de andere kolommen), en
voorafgegaan door een lege lijn, een lijn waarvan enkel de derde
cel is ingevuld (met de indicatie van de quotering,
<strong>horizontaal gecentreerd</strong>), en nogmaals een lege
lijn.</li>
</ol>
<p><a class="popout" href="08.pl">antwoord</a></p>
</dd>
</dl>

        <div id="page-content-end"></div>
    </div>
    <div id="footer">    <div id="metadata">
    Laatst gewijzigd
            op
        22-10-2013
        om
        11:26
        
                door
                    <a href="mailto:Marleen.Denert@UGent.be">Marleen Denert</a>
                
        
    </div>
<div id="tag">intranetr/0.10.0</div>
<div id="footer-end"></div>
</div>
</div>
</div>
</body>

</html>

<!-- 93 ms / 583 KB -->
